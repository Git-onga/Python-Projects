<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
        <title>Binary Tree</title>
        <link rel="stylesheet" href="index.css">
    </head>
    <body>
        <div id="controls">
            <input type="number" id="value" placeholder="Enter number">
            <button id="Insert-btn" onclick="insertNode()">Insert</button>
        </div>
        <div id="tree-container"></div>
        <script>
            class TreeNode{
                constructor(value){
                    this.value = value;
                    this.left = null;
                    this.right = null;
                }
            }
            class BST {
                constructor(){
                    this.root = null;
                }
            
                insert(value){
                    this.root = this._insertRecursive(this.root, value);
                    this.render();
                }
            
                _insertRecursive(node, value){
                    if(!node) return new TreeNode(value);
                    if(value < node.value) node.left = this._insertRecursive(node.left, value);
                    else node.right = this._insertRecursive(node.right, value);
                    return node;
                }
            
                render(){
                    const container = document.getElementById("tree-container");
                    container.innerHTML = "";
                    if(this.root) this._insertRecursive(this.root, container, window.innerWidth /2, 50, window.innerHeight / 4);
                }
            
                _renderNode(node, parentElement, x, y, offset){
                    const nodeElemnt = document.createElement("div");
                    nodeElemnt.classList.add("node");
                    nodeElemnt.textContent = node.value;
                    nodeElemnt.style.left = `${x}px`
                    nodeElemnt.style.top = `${y}px`;
                    parentElement.appendChild(nodeElemnt);
            
                    if(node.left){
                        this._drawLine(x, y, x - offset, y+80);
                        this._renderNode(node.left, parentElement, x - offset, y+80, offset/2);
                    }
            
                    if(node.right){
                        this._drawLine(x, y, x + offset, y+80);
                        this._renderNode(node.right, parentElement, x + offset, y+80, offset/2);
                    }
            
                }
            
                _drawLine(x1, y1, x2, y2){
                    const line = document.createElement("div");
                    line.classList.add("line");
                    const lengt = Math.sqrt((x2 - y1)) ** 2 + (y2 - y1) ** 2;
                    const angle = Math.atan2((y2 - y1, x2 - x1)) * (180 / Math.PI);
                    line.style.width = `${lengt}px`;
                    line.style.height = "2px";
                    line.style.transformOrigin = "0 0";
                    line.style.transform = `rotate(${angle}deg)`;
                    line.style.position = "absolute";
                    line.style.left =  `${x1}px`;
                    line.style.top = `${y1}px`;
                    document.getElementById("tree-container").appendChild(line);
                }


            }
            
            const bst = new BST;
            
            function insertNode(){
                const value = parseInt(document.getElementById("value").value);
                if(!isNaN(value)){
                    bst.insert(value);
                    document.getElementById("value").value = "";
                }
            }

            console.log(bst.render());
        </script>
    </body>
</html>